---
backend: cupy

# raw data source
raw_data:
  type: empad
  path: "~/Downloads/mos2/1/mos2/mos2_0.00_dstep1.0_x64_y64_4DSTEM.raw"
  diff_step: 1.0  # mrad/px
  kv: 120.        # keV

# initialization

init_probe:
  type: 'focused'
  conv_angle: 25  # mrad
  defocus: 300    # angstrom

init_object: 'random'

init_scan:
  type: 'raster'
  shape: [64, 64] # ny, nx
  step_size: 0.6  # angstrom

preprocessing:
 - type: scale
   scale: 1.0

# for each reconstruction engine
engines:
   # how to transition from previous state to current reconstruction state
   # how to reconstruct
   # how to output/save
 - type: 'conventional'
   probe_modes: 1
   niter: 100
   grouping: 64

   noise_model:
     type: 'amplitude'
     eps: 1.0e-8

   solver:
     type: 'epie'
     beta_object: 1.0
     beta_probe: 1.0

   regularizers: []
   # - 'clamp_object_amplitude'
    #- type: 'limit_probe_support'
    #  max_angle: 25

   update_probe: {after: 1}

   #update_every_group: True